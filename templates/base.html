<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Sistema de Citas Médicas{% endblock %}</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet"/>
  <style>
    :root {
      --primary: #0d6efd;
      --sidebar-bg: #1a2a4a;
      --sidebar-text: #cdd9f0;
    }
    body { background: #f0f4f8; }

    /* ── Sidebar ── */
    .sidebar {
      position: fixed; top: 0; left: 0; bottom: 0;
      width: 240px; background: var(--sidebar-bg);
      display: flex; flex-direction: column; padding: 1.5rem 1rem;
      z-index: 100; overflow-y: auto;
    }
    .sidebar .brand {
      color: #fff; font-size: 1.1rem; font-weight: 700;
      margin-bottom: 2rem; text-align: center; letter-spacing: .5px;
    }
    .sidebar .nav-section { font-size: .7rem; color: #7a93b8;
      text-transform: uppercase; letter-spacing: 1px; margin: 1rem 0 .4rem; }
    .sidebar .nav-link {
      color: var(--sidebar-text); border-radius: 8px;
      padding: .5rem .75rem; margin-bottom: .15rem;
      display: flex; align-items: center; gap: .6rem;
      transition: background .2s;
    }
    .sidebar .nav-link:hover, .sidebar .nav-link.active {
      background: rgba(255,255,255,.12); color: #fff;
    }
    .sidebar .nav-link i { font-size: 1rem; }

    /* ── Main content ── */
    .main-content { margin-left: 240px; min-height: 100vh; padding: 1.5rem 2rem; }

    /* ── Cards ── */
    .stat-card { border-radius: 12px; border: none; box-shadow: 0 2px 8px rgba(0,0,0,.08); }
    .stat-card .icon { width: 50px; height: 50px; border-radius: 12px;
      display: flex; align-items: center; justify-content: center; font-size: 1.4rem; }

    /* ── Table ── */
    .table-card { border-radius: 12px; border: none; box-shadow: 0 2px 8px rgba(0,0,0,.08); }
    .table thead th { background: #f8f9fa; font-size: .8rem;
      text-transform: uppercase; letter-spacing: .5px; color: #6c757d; }

    /* ── Badges estados ── */
    .badge-Pendiente  { background: #ffc107 !important; color: #000; }
    .badge-Confirmada { background: #0dcaf0 !important; color: #000; }
    .badge-Completada { background: #198754 !important; }
    .badge-Cancelada  { background: #dc3545 !important; }

    @media (max-width: 768px) {
      .sidebar { width: 100%; position: relative; }
      .main-content { margin-left: 0; }
    }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body>

<!-- ═══════════ SIDEBAR ═══════════ -->
<nav class="sidebar">
  <div class="brand">
    <i class="bi bi-hospital me-2 text-info"></i>
    Citas Médicas
  </div>

  <div class="nav-section">Principal</div>
  <a href="{{ url_for('index') }}"
     class="nav-link {% if request.endpoint == 'index' %}active{% endif %}">
    <i class="bi bi-speedometer2"></i> Dashboard
  </a>

  <div class="nav-section">Gestión</div>
  <a href="{{ url_for('pacientes') }}"
     class="nav-link {% if 'paciente' in request.endpoint %}active{% endif %}">
    <i class="bi bi-people"></i> Pacientes
  </a>
  <a href="{{ url_for('doctores') }}"
     class="nav-link {% if 'doctor' in request.endpoint %}active{% endif %}">
    <i class="bi bi-person-badge"></i> Doctores
  </a>
  <a href="{{ url_for('citas') }}"
     class="nav-link {% if 'cita' in request.endpoint %}active{% endif %}">
    <i class="bi bi-calendar2-check"></i> Citas
  </a>

  <div class="nav-section">Sistema</div>
  <a href="{{ url_for('api_estadisticas') }}" target="_blank"
     class="nav-link">
    <i class="bi bi-code-slash"></i> API JSON
  </a>

  <div class="mt-auto pt-3 border-top border-secondary">
    <small class="text-secondary d-block text-center">Semana 11 · POO + SQLite</small>
  </div>
</nav>

<!-- ═══════════ CONTENIDO ═══════════ -->
<main class="main-content">
  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for cat, msg in messages %}
        <div class="alert alert-{{ cat }} alert-dismissible fade show" role="alert">
          {{ msg }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% block extra_js %}{% endblock %}
</body>
</html>